<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Student Internship Placement Prediction</title>

    </head>
    <body>
        <div class="container">
            <div class="header">
                <h1>Student Placement Predictor</h1>
                <p>Predict your internship placement chances with AI</p>
            </div>

            <form id="predictionForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="iq">
                            IQ Score
                            <span class="tooltip">
                                <span class="info-icon">i</span>
                                <span class="tooltiptext">Intelligence Quotient (70-160)</span>
                            </span>
                        </label>
                        <input type="number" id="iq" name="iq" min="70" max="160" required />
                        <div class="error-message" id="iq-error">IQ must be between 70 and 160</div>
                    </div>

                    <div class="form-group">
                        <label for="prev_sem_result">
                            Previous Semester GPA
                            <span class="tooltip">
                                <span class="info-icon">i</span>
                                <span class="tooltiptext">Previous semester GPA (5.0-10.0)</span>
                            </span>
                        </label>
                        <input
                            type="number"
                            id="prev_sem_result"
                            name="prev_sem_result"
                            min="5.0"
                            max="10.0"
                            step="0.01"
                            required
                        />
                        <div class="error-message" id="prev_sem_result-error">
                            GPA must be between 5.0 and 10.0
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="cgpa">
                            CGPA
                            <span class="tooltip">
                                <span class="info-icon">i</span>
                                <span class="tooltiptext"
                                    >Cumulative Grade Point Average (5.0-10.0)</span
                                >
                            </span>
                        </label>
                        <input
                            type="number"
                            id="cgpa"
                            name="cgpa"
                            min="5.0"
                            max="10.0"
                            step="0.01"
                            required
                        />
                        <div class="error-message" id="cgpa-error">
                            CGPA must be between 5.0 and 10.0
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="academic_performance">
                            Academic Performance
                            <span class="tooltip">
                                <span class="info-icon">i</span>
                                <span class="tooltiptext">Academic rating scale (1-10)</span>
                            </span>
                        </label>
                        <input
                            type="number"
                            id="academic_performance"
                            name="academic_performance"
                            min="1"
                            max="10"
                            required
                        />
                        <div class="error-message" id="academic_performance-error">
                            Academic performance must be between 1 and 10
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="extra_curricular_score">
                            Extra-Curricular Score
                            <span class="tooltip">
                                <span class="info-icon">i</span>
                                <span class="tooltiptext">Extracurricular involvement (0-10)</span>
                            </span>
                        </label>
                        <input
                            type="number"
                            id="extra_curricular_score"
                            name="extra_curricular_score"
                            min="0"
                            max="10"
                            required
                        />
                        <div class="error-message" id="extra_curricular_score-error">
                            Score must be between 0 and 10
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="communication_skills">
                            Communication Skills
                            <span class="tooltip">
                                <span class="info-icon">i</span>
                                <span class="tooltiptext">Communication ability rating (1-10)</span>
                            </span>
                        </label>
                        <input
                            type="number"
                            id="communication_skills"
                            name="communication_skills"
                            min="1"
                            max="10"
                            required
                        />
                        <div class="error-message" id="communication_skills-error">
                            Communication skills must be between 1 and 10
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="projects_completed">
                            Projects Completed
                            <span class="tooltip">
                                <span class="info-icon">i</span>
                                <span class="tooltiptext">Number of projects completed (0-5)</span>
                            </span>
                        </label>
                        <input
                            type="number"
                            id="projects_completed"
                            name="projects_completed"
                            min="0"
                            max="5"
                            required
                        />
                        <div class="error-message" id="projects_completed-error">
                            Projects must be between 0 and 5
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="internship_experience_yes">
                            Internship Experience
                            <span class="tooltip">
                                <span class="info-icon">i</span>
                                <span class="tooltiptext">Previous internship experience</span>
                            </span>
                        </label>
                        <select
                            id="internship_experience_yes"
                            name="internship_experience_yes"
                            required
                        >
                            <option value="">Select...</option>
                            <option value="0">No</option>
                            <option value="1">Yes</option>
                        </select>
                        <div class="error-message" id="internship_experience_yes-error">
                            Please select your internship experience
                        </div>
                    </div>
                </div>

                <button type="submit" class="submit-btn" id="submitBtn">Predict Placement</button>

                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>Analyzing your data...</p>
                </div>

                <div class="result" id="result"></div>
            </form>
        </div>

        <script>
            const form = document.getElementById('predictionForm');
            const submitBtn = document.getElementById('submitBtn');
            const loading = document.getElementById('loading');
            const result = document.getElementById('result');

            // Validation rules
            const validationRules = {
                iq: { min: 70, max: 160 },
                prev_sem_result: { min: 5.0, max: 10.0 },
                cgpa: { min: 5.0, max: 10.0 },
                academic_performance: { min: 1, max: 10 },
                extra_curricular_score: { min: 0, max: 10 },
                communication_skills: { min: 1, max: 10 },
                projects_completed: { min: 0, max: 5 },
            };

            // Real-time validation
            Object.keys(validationRules).forEach((fieldName) => {
                const field = document.getElementById(fieldName);
                const errorDiv = document.getElementById(fieldName + '-error');

                field.addEventListener('input', () => {
                    validateField(fieldName, field, errorDiv);
                });

                field.addEventListener('blur', () => {
                    validateField(fieldName, field, errorDiv);
                });
            });

            // Validate internship experience dropdown
            const internshipField = document.getElementById('internship_experience_yes');
            const internshipError = document.getElementById('internship_experience_yes-error');

            internshipField.addEventListener('change', () => {
                if (internshipField.value === '') {
                    showError(
                        internshipField,
                        internshipError,
                        'Please select your internship experience'
                    );
                } else {
                    showSuccess(internshipField, internshipError);
                }
            });

            function validateField(fieldName, field, errorDiv) {
                const value = parseFloat(field.value);
                const rules = validationRules[fieldName];

                if (field.value === '') {
                    showError(field, errorDiv, 'This field is required');
                    return false;
                }

                if (isNaN(value)) {
                    showError(field, errorDiv, 'Please enter a valid number');
                    return false;
                }

                if (value < rules.min || value > rules.max) {
                    showError(
                        field,
                        errorDiv,
                        `Value must be between ${rules.min} and ${rules.max}`
                    );
                    return false;
                }

                showSuccess(field, errorDiv);
                return true;
            }

            function showError(field, errorDiv, message) {
                field.classList.remove('success');
                field.classList.add('error');
                errorDiv.textContent = message;
                errorDiv.style.display = 'block';
            }

            function showSuccess(field, errorDiv) {
                field.classList.remove('error');
                field.classList.add('success');
                errorDiv.style.display = 'none';
            }

            function validateForm() {
                let isValid = true;

                // Validate all numeric fields
                Object.keys(validationRules).forEach((fieldName) => {
                    const field = document.getElementById(fieldName);
                    const errorDiv = document.getElementById(fieldName + '-error');
                    if (!validateField(fieldName, field, errorDiv)) {
                        isValid = false;
                    }
                });

                // Validate internship experience
                if (internshipField.value === '') {
                    showError(
                        internshipField,
                        internshipError,
                        'Please select your internship experience'
                    );
                    isValid = false;
                }

                return isValid;
            }

            form.addEventListener('submit', async (e) => {
                e.preventDefault();

                if (!validateForm()) {
                    showResult('Please correct the errors above', 'error');
                    return;
                }

                // Show loading state
                submitBtn.disabled = true;
                loading.style.display = 'block';
                result.style.display = 'none';

                const formData = new FormData(form);
                const data = {};

                // Convert form data to numbers
                for (let [key, value] of formData.entries()) {
                    data[key] =
                        key === 'internship_experience_yes' ? parseInt(value) : parseFloat(value);
                }

                try {
                    const response = await fetch('http://127.0.0.1:5000/predict', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(data),
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const resultData = await response.json();

                    if (resultData.error) {
                        showResult(`Error: ${resultData.error}`, 'error');
                    } else {
                        const isSelected = resultData.prediction === 1;
                        const message = isSelected
                            ? '🎉 Congratulations! You are likely to be selected for the internship!'
                            : '😔 Based on the analysis, you might not be selected for the internship. Consider improving your skills!';

                        showResult(message, isSelected ? 'success' : 'failure');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    showResult(
                        'Network error. Please check if the server is running and try again.',
                        'error'
                    );
                } finally {
                    // Hide loading state
                    submitBtn.disabled = false;
                    loading.style.display = 'none';
                }
            });

            function showResult(message, type) {
                result.textContent = message;
                result.className = `result ${type}`;
                result.style.display = 'block';
                result.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }

            // Form reset functionality
            function resetForm() {
                form.reset();
                result.style.display = 'none';

                // Reset all field states
                const fields = form.querySelectorAll('input, select');
                fields.forEach((field) => {
                    field.classList.remove('error', 'success');
                });

                const errorMessages = form.querySelectorAll('.error-message');
                errorMessages.forEach((error) => {
                    error.style.display = 'none';
                });
            }

            // Add reset button functionality (optional)
            const resetBtn = document.createElement('button');
            resetBtn.textContent = 'Reset Form';
            resetBtn.type = 'button';
            resetBtn.className = 'submit-btn';
            resetBtn.style.background = '#6c757d';
            resetBtn.style.marginTop = '10px';
            resetBtn.addEventListener('click', resetForm);

            // Uncomment the line below if you want to add a reset button
            // form.appendChild(resetBtn);
        </script>
    </body>
</html>
